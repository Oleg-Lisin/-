
# Правила игры сводятся к тому, что вам дают две карты и вы должны приблизится к числу 21. Вы можете брать дополнительные карты из колоды,
# но если вы получите число более 21, то автоматически проиграли. Кроме того, если число получилось наименьшим из тех, которые есть у ваших соперников,
# то вы также проиграли.
#
# Для реализации вам понадобится колода карт, из которой вы каждый раз будете вынимать по карте и прибавлять к результату.
# Представим, что у нас есть следующие карты: шестерка, семерка, восьмерка, девятка, десятка, валет (его значение равно числу 2),
# дама (3), король (4), и туз (11).
#
# Ваша задача разработать программу для игры в «Блэкджек».

# Для меньшей загруженности программы масти были упразднены, но количество карт в колоде от каждй масти сохранено.

import random

players = int(input('Введите количество игроков (не больше 18:)'))
while players >= 18:
    players = int(input('Введите количество игроков (не больше 18:)'))

# создание списка колоды и ее перемешивание
deck = [6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 10, 10, 10, 10, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 11, 11, 11, 11]
# deck = [1, 1, 1, 2]
random.shuffle(deck)

# Создание словаря с игроками и первоначальными двумя картами
names = {}
for i in range(1, players+1):
    print('Введите имя игрока', i)
    name = input()
    names[name] = deck[0:2]
    print('Игрок', name, ', Вам достались следующие карты:', deck[0], 'и', deck[1])
    # print('Сумма очков игрока', name, 'равна', sum(deck[0:2]))
    # удаление взятых карт из колоды игроком
    deck.pop(0)
    deck.pop(0)

# реализация игрового процесса
#блок проверки полученной суммы карт после первоначальной раздачи
names2 = names.copy()
for key, value in names2.items():
    if sum(value) == 21:
        print('Игрок', key, 'выиграл(а), сумма очков равна 21')
        names['Победитель'] = key
    elif sum(value) > 21:
        print('Игрок', key, 'проиграл(а) и вылетает из игры, сумма очков больше 21 и равна', sum(value))
        del names[key]

while 'Победитель' not in names.keys() and len(deck) >= players:
    copy_names = names.copy()  # копия для возможности удаления из словаря при переборе

    if len(names.keys()) == 1:
        x = list(names.keys()) # преобразуем единственный оставшийся ключ словаря в список
        print('Игрок', x[0], 'побеждает, так как все остальные игроки вылетели')
        break
    else:
        if len(deck) == players:
            print('Внимание!, последний круг игры')
        elif len(deck) < players:
            print('Карт в колоде недостаточно для продолжения игры (каждый игрок не сможет взять карту), выигрывает игрок '
                  'с наибольшей суммой очков, но которая меньше 21')
            break

        list_else = [] # Создание списка для выполнения условия вылета игрока с наименьшим кол-ом очков

        for key, value in copy_names.items():
            print(key, ',', 'сумма очков равна', sum(value),
                  '\n берем карту из колоды?, если да, введите 1, если нет - 0 или другое значение')
            take = int(input())
            if take == 1:
                names[key] += deck[0:1]
                deck.pop(0)
                print(key, 'сумма очков равна', sum(value))
            if sum(value) == 21:
                names['Победитель'] = key
                print('Игрок', key, 'выиграл(а), сумма очков равна 21')
            elif sum(value) > 21:
                print('Игрок', key, 'выбывает из игры, сумма очков больше 21 и равна', sum(value))
                del names[key]
            else:
                list_else.append(value)

        names3 = names.copy()

        if list_else == list(names3.values()) and len(names3.keys()) > 1: # Условие вылета игрока с наименьшим кол-ом очков
            sums = {}
            for key, value in names3.items():
                summa = 0
                for y in value:
                    summa += y
                    sums[key] = summa
            min_summa = min(sums, key=sums.get)
            print('Игрок', min_summa, 'выбывает из игры, у Вас наименьшее количество очков')
            del names[min_summa]
